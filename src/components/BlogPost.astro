---
import {dateStr, dateIso} from '../utils'

export interface Props {
  post: any
}

const { title, publishDate, heroImage, tags, category } = Astro.props.post;

const tagsStr = (await Promise.all(tags.map(tag => <a href={`/tag/${tag}`}>{tag}</a>))).join(', ')
---

<article class="article">
  <header>
    {heroImage && <img class="hero-image" loading="lazy" src={`/assets/${heroImage}`} />}
    <div class={`prose mx-16 max-w-screen-md mx-auto pt-12 ${!heroImage && 'mt-48'}`}>
      <h1>{title}</h1>
      <p><span class="mt-1 text-sm">By <strong>Johan Stenehall</strong> / <time datetime={dateIso(publishDate)}>{dateStr(publishDate)}</time></span>
    </div>
  </header>
  <main class="prose mx-16 max-w-screen-md mx-auto pb-12">
    <slot />
  </main>
  <footer class="text-sm pb-12 flex flex-col items-center">
    <div>
      <p class="text-sm">This was filled under <a href={`/category/${category}`} class="" title={category}>{category}</a>
      with some tags: {tagsStr}
      </p>
    </div>
  </footer>
</article>

<style>
.tag::before {
  content: "/"
}

.hero-image {
  width: 100vw;
  object-fit: cover;
  object-position: center;
  max-width: 1280px;
  max-height: 50vh;
  position: relative;
  left: 0;
  margin: 0;
}

footer::before {
    content: "";
    width: 30vw;
    max-width: 200px;
    height: 10px;
    display: block;
    border-top: 1px solid currentColor;
    margin: 0 auto 3rem;
}

article::after {
    content: "";
    width: 30vw;
    max-width: 200px;
    height: 10px;
    display: block;
    border-bottom: 1px solid currentColor;
    margin: 0 auto 2em;
}

@media (max-width: 50em) {
  .hero-image {
    height: 260px;
  }
}
</style>
